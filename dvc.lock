schema: '2.0'
stages:
  transpose:
    cmd: python src/data/select_region.py data/raw/all_v2.csv data/interim/data_regional.csv
      2661
    deps:
    - path: data/raw/all_v2.csv
      md5: 00af12733984c983b49f412cef232a9f
      size: 408179741
    - path: src/data/select_region.py
      md5: 34da5d0ba8c5b0a3b97121f4780807aa
      size: 809
    outs:
    - path: data/interim/data_regional.csv
      md5: 985bf5b3d1ac2dfac93e2f5b991296b5
      size: 36542699
  select_region:
    cmd: python src/data/select_region.py data/raw/all_v2.csv data/interim/data_regional.csv
      2661
    deps:
    - path: data/raw/all_v2.csv
      md5: 00af12733984c983b49f412cef232a9f
      size: 408179741
    - path: src/data/select_region.py
      md5: a10209ac98a43fb10cfffab4bce14cb0
      size: 795
    outs:
    - path: data/interim/data_regional.csv
      md5: ce43fe511dd122670f536b2ef3d26136
      size: 32927996
  clean_data:
    cmd: python src/data/clean_data.py data/interim/data_regional.csv data/interim/data_cleaned.csv
    deps:
    - path: data/interim/data_regional.csv
      md5: ce43fe511dd122670f536b2ef3d26136
      size: 32927996
    - path: src/data/clean_data.py
      md5: f7d64d2312b54d4d7068e6fe60b43c6d
      size: 1758
    outs:
    - path: data/interim/data_cleaned.csv
      md5: 2ce0d77bd4513d6caf1a99ee454f62a7
      size: 28625276
  add_features:
    cmd: python src/features/add_features.py data/interim/data_cleaned.csv data/interim/data_featured.csv
    deps:
    - path: data/interim/data_cleaned.csv
      md5: 2ce0d77bd4513d6caf1a99ee454f62a7
      size: 28625276
    - path: src/features/add_features.py
      md5: db51bf3074135298ab337f7711da7891
      size: 950
    outs:
    - path: data/interim/data_featured.csv
      md5: c5ccc14a8760fa8039b5bee9d5aaf7a9
      size: 35930273
  get_osm_cafes_data:
    cmd: python src/data/get_osm_cafes_data.py "https://maps.mail.ru/osm/tools/overpass/api/interpreter?data=[out:json];nwr['addr:street'='Лиговский
      проспект']['addr:housenumber'=101];node[amenity=cafe](around:25000);out geom;"
      data/external/data_cafes.geojson
    deps:
    - path: src/data/get_osm_cafes_data.py
      md5: d2c8fed42242aa69c52e18153d69b4c6
      size: 828
    outs:
    - path: data/external/data_cafes.geojson
      md5: 404d95d65a5a1530e91983653bf93862
      size: 1235291
  add_cafes_in_radius:
    cmd: python src/features/add_cafe_radius_features.py data/interim/data_featured.csv
      data/external/data_cafes.geojson data/processed/dataset.csv
    deps:
    - path: data/external/data_cafes.geojson
      md5: 404d95d65a5a1530e91983653bf93862
      size: 1235291
    - path: data/interim/data_featured.csv
      md5: c5ccc14a8760fa8039b5bee9d5aaf7a9
      size: 35930273
    - path: src/features/add_cafe_radius_features.py
      md5: 75777111f48c1d74d41d033ad9378167
      size: 1927
    outs:
    - path: data/processed/dataset.csv
      md5: c11c485d4536ddba2bfe41d8c7b1a0d9
      size: 53966746
  prepare_datasets:
    cmd: python src/models/prepare_datasets.py data/processed/dataset.csv data/processed/train.csv
      data/processed/test.csv
    deps:
    - path: data/processed/dataset.csv
      md5: c11c485d4536ddba2bfe41d8c7b1a0d9
      size: 53966746
    - path: src/models/prepare_datasets.py
      md5: 4b1b8ffd978ea2e2cf54cdcc34c8eef0
      size: 888
    outs:
    - path: data/processed/test.csv
      md5: d5d058049adadf5625d00c8d970a854a
      size: 6821741
    - path: data/processed/train.csv
      md5: ee0be7133a5bcfcf7cfbe10da122b975
      size: 20465747
  train:
    cmd: python src/models/train.py data/processed/train.csv data/processed/test.csv
      models/model.clf reports/metrics.json
    deps:
    - path: data/processed/test.csv
      md5: d5d058049adadf5625d00c8d970a854a
      size: 6821741
    - path: data/processed/train.csv
      md5: ee0be7133a5bcfcf7cfbe10da122b975
      size: 20465747
    - path: src/models/train.py
<<<<<<< HEAD
      md5: 3a3983d5f4cd0f68462c5972150a0385
      size: 1630
    outs:
    - path: models/model.clf
      md5: 421be50aadb3a9b50a24fd7345b848e0
      size: 3926952
=======
      md5: cb4788a7c2517c2ed241cec93a92d403
      size: 2648
    outs:
    - path: models/model.clf
      md5: fcefa2a5afe1ece9f2ddc385770f953a
      size: 11995820
    - path: reports/metrics.json
      md5: d7afbac5698d75bdad86837db0275ecf
      size: 66
>>>>>>> dev2
  evaluate:
    cmd: python src/models/evaluate.py data/processed/test.csv models/model.clf reports/metrics.json
    deps:
    - path: models/model.clf
<<<<<<< HEAD
      md5: 421be50aadb3a9b50a24fd7345b848e0
      size: 3926952
=======
      md5: 7dcf661f668f5a6264f82c44587b6ac0
      size: 15193908
>>>>>>> dev2
    - path: src/models/evaluate.py
      md5: 1fde15198ea482654ca7899f246158b9
      size: 998
    outs:
<<<<<<< HEAD
    - path: reports/scores.csv
      md5: 6e919503793f7235ff6f927a7cfd0278
      size: 45
=======
    - path: reports/metrics.json
      md5: 6e672a7e88471492f6c76d87c8ceef17
      size: 88
>>>>>>> dev2
